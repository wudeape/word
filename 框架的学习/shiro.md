## 权限管理的实现  

#实际操作
1 pom支持，web.xml  然后是 ini 文件

# shiro 的基础知识
  权限管理  ： 用户认证 和用户授权
  用户认证的方法：最常用的用户身份验证的方法：1、用户名密码方式、2、指纹打卡机、3、基于证书验证方法。。系统验证用户身份合法，用户方可访问系统的资源
  流程
  * 判断资源能否不认证就能实现访问
  * 如果需要认证，是否已经认证
  * 没有认证，返回认证页面（登录页面）
  * 认证后才能访问资源
 具体的如何进行认证  1 确定subject 认证成功 2 principal身份信息验证 3 或者是一些credentials凭证信息

# 权限管理模型
 访问控制 ，认证成功后 用具有资源的权限进行 访问控制
 用户授权的流程：
   +subject必须具有访问资源的权限 才可访问
   +权限/许可:subject 具有permission访问资源  具体的实现需要定义permission 

  * 主体（账号、密码）
  * 资源（资源名称、访问地址）
  * 角色（角色名称）
  * 角色和权限关系（角色id、权限id）
  * 主体和角色关系（主体id、角色id
 通常将资源表和权限表合并为一张表
 * 权限（权限名称，资源名称，资源访问地址）

  ##权限的分配
  用户需要分配相应的权限才可访问相应的资源。权限是对于资源的操作许可
 若是想 将权限信息持久化 需要把存储在关系数据库中
  ## 需要注意的是，基于角色访问控制权限的话可拓展性不是很高，一般都是基于资源的访问控制全的修改


  基于角色的授予，具体的权限应该自动封装在角色中
  <pre>
  	 if(user.hasrole(‘部门经理’)){
  	 //资源内容
  	 //用户表查看
  	 //基于角色的权限控制（角色发生改变权限发生改变）
  	}
  </pre>

  <pre>
  	if(user.haspermission('用户权限查看表（权限标识符）')){
  	//资源内容
  	 //用户表查看
  	 //基于资源的访问控制
  }
  </pre>
  在jsp上进行授权
  <pre>
     <shiro:hasRole name="admin"> 
      <!— 有权限 —> 
      </shiro:hasRole> 
  </pre>

# 粗粒度和细粒度权限
  * 细粒度权限管理 ：对资源实例的权限管理 
  * 粗粒度权限管理 ：超级管理员可以访问户添加页面、用户信息等全部页面。部门管理员可以访问用户信息页面包括 页面中所有按钮
  注意 细粒度权限的管理就是数据库级别的管理
   + 粗粒度的权限容易抽取出来个系统的架构系统级别统一处理，比如通过springMVC的拦截器实现授权
   + 对细粒度权限管理在数据级别是没有共性可言，针对细粒度权限管理就是系统业务逻辑的一部分，在业务层去处理相对比较简单
   + 部门经理只查询本部门员工信息，在service接口提供一个部门id的参数，controller中根据当前用户的信息得到该 用户属于哪个部门，调用service时将部门id传入service，实现该用户只查询本部门的员工

# 关于URL的拦截
  *在权限表的中没有资源的添加 使用map来进行替代
   具体的实现在
   https://blog.csdn.net/hon_3y/article/details/61926175
  * 动态代理 和注解 实现拦截
    + 在Controller得到service对象的时候，service工 厂返回的是一个动态代理对象回去
     Controller拿着代理对象去调用方法，代理对象就会去解析该方法上是否有注解
     + 如果有注解，那么就需要我们进行判断该主体是否认证了，如果认证了就判断该主体是否有权限
     当我们解析出该主体的权限和我们注解的权限是一致的时候，才放行
   + 具体的实现 是真tmd 没耐心看了  shiro我需要你


# shiro的具体实现
  首先是shiro认证具体流程  具体的构造核心的sercurityManager环境，----<<< 然后进行subject.login（）提交认证----<<securityManger.login() 执行认证  ---<<<
  authenticator 执行认证 ---<< realm 获取验证信息   （验证的过程）

   ## 具体的流程 （授权的实现）
    .ini 文件进行 用户信息的配置  （若是数据很大的话 不是采用此种方式）



    具体的环境的配置详见 redis和shiro 文档
    。。  待定

   ##  realm 是进行相应权限控制和数据库验证的对象
     







